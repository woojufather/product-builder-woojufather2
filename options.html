<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ES9BFXNYPM"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-ES9BFXNYPM');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HelpOpen 구매하기 | 수량 선택 및 결제</title>
    <meta name="description" content="HelpOpen 도어 잠김 해제장치 구매 페이지입니다. 수량을 선택하고 안전한 결제를 진행하세요.">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        .options-container {
            max-width: 600px;
            margin: 50px auto;
            padding: 30px;
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .option-group {
            margin-bottom: 25px;
        }
        .option-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        /* Quantity Selector Styles */
        .quantity-selector {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--light-bg);
            padding: 5px;
            border-radius: 8px;
            width: fit-content;
        }
        .qty-btn {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            border: 1px solid #ddd;
            background: white;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
            color: var(--text-color);
        }
        .qty-btn:hover {
            background: #f0f0f0;
        }
        .qty-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        #quantity-display {
            width: 60px;
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            border: none;
            background: transparent;
            color: var(--text-color);
        }

        .price-info {
            border-top: 1px solid #eee;
            margin-top: 30px;
            padding-top: 20px;
        }
        .price-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        .shipping-notice {
            font-size: 0.85rem;
            color: var(--primary-color);
            margin-top: -5px;
            margin-bottom: 10px;
            text-align: right;
        }
        .total-price {
            font-size: 1.8rem;
            font-weight: bold;
            text-align: right;
            margin-top: 10px;
            color: var(--accent-color);
        }
        .final-buy-button {
            width: 100%;
            padding: 18px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            transition: opacity 0.2s;
        }
        .final-buy-button:hover {
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo"><a href="index.html" style="text-decoration: none; color: inherit;">HelpOpen</a></div>
        </nav>
    </header>

    <main>
        <div class="options-container">
            <h1>주문 수량 선택</h1>
            <p style="margin-bottom: 30px; opacity: 0.7;">HelpOpen 도어 잠김 해제장치</p>

            <div class="option-group">
                <label for="quantity">수량 (최대 100개)</label>
                <div class="quantity-selector">
                    <button type="button" class="qty-btn" id="minus-btn" aria-label="수량 감소">-</button>
                    <input type="number" id="quantity-display" value="1" min="1" max="100">
                    <button type="button" class="qty-btn" id="plus-btn" aria-label="수량 증가">+</button>
                </div>
            </div>

            <div class="price-info">
                <div class="price-row">
                    <span>상품 금액</span>
                    <span id="product-price">10,000원</span>
                </div>
                <div class="price-row">
                    <span>배송비</span>
                    <span id="shipping-fee">3,000원</span>
                </div>
                <div class="shipping-notice" id="shipping-notice">
                    * 5개 이상 구매 시 배송비 무료
                </div>
                <div class="total-price" id="total-display">
                    총 합계: 13,000원
                </div>
            </div>

            <button class="final-buy-button">결제하기</button>
        </div>
    </main>

    <footer>
        <p>&copy; 2026 HelpOpen Patent Solution. All rights reserved.</p>
    </footer>

    <script>
        const minusBtn = document.getElementById('minus-btn');
        const plusBtn = document.getElementById('plus-btn');
        const quantityDisplay = document.getElementById('quantity-display');
        const productPriceText = document.getElementById('product-price');
        const shippingFeeText = document.getElementById('shipping-fee');
        const totalDisplayText = document.getElementById('total-display');
        const shippingNotice = document.getElementById('shipping-notice');
        
        const UNIT_PRICE = 10000;
        const DEFAULT_SHIPPING_FEE = 3000;
        const FREE_SHIPPING_THRESHOLD = 5;
        const MAX_QUANTITY = 100;

        let currentQuantity = 1;

        function updateDisplay(updateInput = true) {
            // Update quantity text only if requested (to avoid cursor jumping while typing)
            if (updateInput) {
                quantityDisplay.value = currentQuantity;
            }

            // Calculate prices
            const productTotal = UNIT_PRICE * currentQuantity;
            const isFreeShipping = currentQuantity >= FREE_SHIPPING_THRESHOLD;
            const currentShippingFee = isFreeShipping ? 0 : DEFAULT_SHIPPING_FEE;
            const finalTotal = productTotal + currentShippingFee;

            // Update text elements
            productPriceText.textContent = productTotal.toLocaleString() + '원';
            
            if (isFreeShipping) {
                shippingFeeText.textContent = '무료';
                shippingFeeText.style.color = 'var(--primary-color)';
                shippingNotice.textContent = '✓ 5개 이상 구매로 배송비가 면제되었습니다.';
            } else {
                shippingFeeText.textContent = DEFAULT_SHIPPING_FEE.toLocaleString() + '원';
                shippingFeeText.style.color = 'inherit';
                shippingNotice.textContent = '* 5개 이상 구매 시 배송비 무료';
            }

            totalDisplayText.textContent = '총 합계: ' + finalTotal.toLocaleString() + '원';

            // Button states
            minusBtn.disabled = currentQuantity <= 1;
            plusBtn.disabled = currentQuantity >= MAX_QUANTITY;
        }

        // Handle manual input
        quantityDisplay.addEventListener('input', (e) => {
            let value = parseInt(e.target.value);
            
            if (isNaN(value)) {
                currentQuantity = 1;
            } else if (value > MAX_QUANTITY) {
                currentQuantity = MAX_QUANTITY;
                e.target.value = MAX_QUANTITY;
            } else if (value < 1) {
                currentQuantity = 1;
                // Don't force reset value to 1 immediately to allow typing (e.g. clearing the field)
            } else {
                currentQuantity = value;
            }
            
            updateDisplay(false); // Don't reset input value while typing
        });

        // Ensure valid value on blur
        quantityDisplay.addEventListener('blur', (e) => {
            let value = parseInt(e.target.value);
            if (isNaN(value) || value < 1) {
                currentQuantity = 1;
            }
            updateDisplay(true); // Force reset to valid value
        });

        minusBtn.addEventListener('click', () => {
            if (currentQuantity > 1) {
                currentQuantity--;
                updateDisplay(true);
            }
        });

        plusBtn.addEventListener('click', () => {
            if (currentQuantity < MAX_QUANTITY) {
                currentQuantity++;
                updateDisplay(true);
            }
        });

        // Initialize
        updateDisplay();
    </script>
</body>
</html>
